<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Replace <Your Full Name> with your name here  -->
    <title>Phuc Huynh Tan's Weekly Readings</title>
    <link rel="stylesheet" href="/style/list.css">
    <!-- Include your favicon here -->

    <!-- Including Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
      
</head>
<body>
    <div class="container mx-auto min-vh-100 d-flex flex-column">

<!-- Header, the first section of the page-->
<header class="header" id="header-container">
    <img src="/images/cat-pondering-cat.png" alt="logo" width="64" height="64">
    <a href="/">Home Page</a>
</header>

<!-- Main content -->
<main>
    
    <!-- Your profile-->
     <div class="container-fluid reading-books">
        <div class="row">
                <aside id="profile">
                    <div>
                        <img src="/images/black-black-man.gif" alt="" height="250" id="pfp">
                    </div>
                    <div>
                        <div class="mb-4">
                            <span>Hi, I'm</span>
                            <h1>John Doe</h1>
                        </div>
                        <div class="personal-info">
                            <h5>s1234565</h5>
                            <h5>joe.mama@rmit.edu.vn</h5>
                        </div>
                    </div>
            </aside>
            <section id="reading-list">
                    <h2 class="text-end p-3">Recommended <b>READING LIST</b></h2>
                    <div id="reading-plan" class="d-flex justify-content-end">
                        <form action="/" method="POST">
                            <input type="hidden" name="currentListId" value="<%= list ? list._id : '' %>">
                                <button type="refresh" id="refresh-btn" onclick="location.reload()">Refresh</button>
                        </form>
                        
                    </div>
                   
                    <% if(list && list.books && list.books.length){%>
                        <% 
                            const categoryOrder = ["TEXTBOOK", "PHILOSOPHY", "NOVEL"];
                            const dayMap = {
                                TEXTBOOK: "Monday - Wednesday",
                                PHILOSOPHY: "Thursday - Friday",
                                NOVEL: "Saturday - Sunday"  
                            };
                            const picks = categoryOrder.map((category) => {
                                return list.books.find((book) => {
                                    return (book.category || "").toUpperCase() === category;
                                });
                            });
                        %>
                        <% picks.forEach((book, index) => { %>
                            <span><%= (book.category || "").toUpperCase() %></span>
                            <span><%= dayMap[categoryOrder[index]] %></span>
                            <div class="book-content">

                                    <% if(book){ %>
                                    <% console.log("list.ejs: image src", book.imageUrl || book.image); %>
                           
                                
                                  
                                            <a href="/book/<%= encodeURIComponent(book.title)%>">
                                                <img src="<%= book.imageUrl || book.image %>" height="300"  alt="<%= book.title %>" style="border-radius: 8px;">
                                                <section>
                                                    <h3><%= book.title %></h3>
                                                    <span><%= book.author %></span>
                                                    <p><%= book.description%></p>
                                                </section>
                                            </a>
                                    
                                    
                                <% } else { %>
                                    <section>
                                        <h3><%= categoryOrder[index] %></h3>
                                        <span>No book found for this category.</span>
                                        <span><%= dayMap[categoryOrder[index]] %></span>
                                    </section>
                                <% } %>
                            </div>
                        <% }) %>
                    <% } else { %>
                        <p>No books are found!</p>
                    <% } %>
            </section> 
        </div>
            
      </div>
</main>
    
 <!-- Footer -->
        <footer class="footer-container">
            Made with ðŸ§Œ by  <p style="font-weight: bold;"> Phuc Huynh Tan</p>
        </footer>
    </div>


<!-- Including Boostrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
</body>
</html>
